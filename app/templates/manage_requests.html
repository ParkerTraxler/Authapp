{% extends 'base.html' %}
{% block title %}Academic Requests{% endblock %}

{% block content %}

<h2 class="mb-3">Request Management</h2>

<!-- FERPA -->
<h3 class="mb-3">FERPA Requests</h3>
<table class="table">
	<thead>
		<tr>
			<th>Status</th>
			<th>Time Requested</th>
			<th>File</th>
			<th>Actions</th>
		</tr>
	</thead>
	<tbody>
		{% for ferpa_request in ferpa_requests %}
		<tr>
			<td><span class="{% if ferpa_request.status == 'approved' %} text-success
				{% elif ferpa_request.status == 'pending' %} text-warning
				{% elif ferpa_request.status == 'draft' %} text-info
				{% elif ferpa_request.status == 'rejected' %} text-danger
				{% elif ferpa_request.status == 'returned' %} text-secondary {% endif %}">
				{{ ferpa_request.status.capitalize() }}</span></td>	
			<td>{{ ferpa_request.time }}</td>
			<td><a href="{{ url_for('main.download_file', filename=ferpa_request.pdf_link) }}" class="btn btn-outline-primary btn-sm">File</a></td>
			<td>
				{% if ferpa_request.status != "approved" and ferpa_request.status != "returned" and ferpa_request.status != "rejected" %}
                <form action="{{ url_for('manager.approve_ferpa_request', id=ferpa_request.id) }}" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-success">Approve</button>
                </form>
                <form action="{{ url_for('manager.return_ferpa_request', id=ferpa_request.id) }}" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-warning">Return</button>
                </form>
				<form action="{{ url_for('manager.reject_ferpa_request', id=ferpa_request.id) }}" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-danger">Reject</button>
                </form>
				{% else %} No actions available.
				{% endif %}
            </td>
		</tr>
		{% endfor %}
	</tbody>
</table>

<!-- Info Change -->
<h3 class="mb-3">Name/SSN Change Requests</h3>
<table class="table">
	<thead>
		<tr>
			<th>Status</th>
			<th>Time Requested</th>
			<th>File</th>
			<th>Actions</th>
		</tr>
	</thead>
	<tbody>
		{% for infochange_request in infochange_requests %}
		<tr>
			<td><span class="{% if infochange_request.status == 'approved' %} text-success
				{% elif infochange_request.status == 'pending' %} text-warning
				{% elif infochange_request.status == 'draft' %} text-info
				{% elif infochange_request.status == 'rejected' %} text-danger
				{% elif infochange_request.status == 'returned' %} text-secondary {% endif %}">
				{{ infochange_request.status.capitalize() }}</span></td>
			<td>{{ infochange_request.time }}</td>
			<td><a href="{{ url_for('main.download_file', filename=infochange_request.pdf_link) }}" class="btn btn-outline-primary btn-sm">File</a></td>
			<td>
				{% if infochange_request.status != "approved" and infochange_request.status != "returned" and infochange_request.status != "rejected" %}
                <form action="{{ url_for('manager.approve_infochange_request', id=infochange_request.id) }}" method="post" style="display:inline;">
					<button type="submit" class="btn btn-success">Approve</button>
                </form>
                <form action="{{ url_for('manager.return_infochange_request', id=infochange_request.id) }}" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-warning">Return</button>
                </form>
				<form action="{{ url_for('manager.reject_infochange_request', id=infochange_request.id) }}" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-danger">Reject</button>
                </form>
				{% else %} No action available.
				{% endif %}
            </td>
		</tr>
		{% endfor %}
	</tbody>
</table>
</table>

{% endblock %}
